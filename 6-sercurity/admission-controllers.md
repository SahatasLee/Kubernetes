# Admission Controller

‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‚ú® ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏î‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏•‡∏∂‡∏Å‚Äù ‡∏Ç‡∏≠‡∏á Kubernetes ‚Äî
‡∏°‡∏≤‡∏î‡∏π‡∏ß‡πà‡∏≤ **Admission Control (Admission Controllers)** ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏Å‡∏±‡∏ô

---

## üß© **Kubernetes Admission Control ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£**

> üß† **Admission Controllers** ‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á Plugin‚Äù ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (validate)** ‡πÅ‡∏•‡∏∞ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (mutate)**
> ‡∏Ñ‡∏≥‡∏Ç‡∏≠ (request) ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏¢‡∏±‡∏á **Kubernetes API Server** ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á etcd

‡∏û‡∏π‡∏î‡∏á‡πà‡∏≤‡∏¢ ‡πÜ

> Admission Controller = ‡∏î‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà object ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡∏•‡∏ö‚Äù ‡πÉ‡∏ô cluster

---

## üîÑ **‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Request ‡πÉ‡∏ô Kubernetes**

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô (‡∏´‡∏£‡∏∑‡∏≠ Pod) ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á ‡πÄ‡∏ä‡πà‡∏ô `kubectl create pod ...`

‡∏à‡∏∞‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```
1Ô∏è‚É£ Authentication     ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ‚Äú‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏Ñ‡∏£‚Äù
2Ô∏è‚É£ Authorization      ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ‚Äú‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏´‡∏°‚Äù
3Ô∏è‚É£ Admission Control  ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ‚Äú‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ó‡∏≥ ‡∏ñ‡∏π‡∏Å‡∏Å‡∏é‡∏Ç‡∏≠‡∏á cluster ‡πÑ‡∏´‡∏°‚Äù
4Ô∏è‚É£ etcd               ‚Üí ‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏£‡∏¥‡∏á
```

üéØ Admission Control ‡∏à‡∏∂‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô "‡∏ú‡∏π‡πâ‡∏Ñ‡∏∏‡∏°‡∏Å‡∏é" ‡∏£‡∏∞‡∏î‡∏±‡∏ö policy ‡∏Ç‡∏≠‡∏á cluster

---

## ‚öôÔ∏è **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á Admission Controllers**

Admission Controllers ‡πÅ‡∏ö‡πà‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏´‡∏ç‡πà:

| ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó                               | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà                                         | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á                                                                |
| ------------------------------------ | ----------------------------------------------- | ----------------------------------------------------------------------- |
| **Mutating Admission Controllers**   | ‚Äú‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‚Äù object ‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (inject, ‡πÄ‡∏û‡∏¥‡πà‡∏° field) | `MutatingAdmissionWebhook`, `DefaultStorageClass`, `NamespaceLifecycle` |
| **Validating Admission Controllers** | ‚Äú‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‚Äù object ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏° policy ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà   | `ValidatingAdmissionWebhook`, `ResourceQuota`, `PodSecurity`            |

---

## üß± **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Admission Controllers ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢**

| Controller                     | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà                                                                         |
| ------------------------------ | ------------------------------------------------------------------------------- |
| **NamespaceLifecycle**         | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á resource ‡πÉ‡∏ô namespace ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà ‡∏´‡∏£‡∏∑‡∏≠ namespace ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏•‡∏ö |
| **LimitRanger**                | ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ default/maximum ‡∏Ç‡∏≠‡∏á resource requests/limits                          |
| **ServiceAccount**             | ‡∏ú‡∏π‡∏Å ServiceAccount ‡πÉ‡∏´‡πâ Pod ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥                                            |
| **NodeRestriction**            | ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà kubelet ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô Node, Pod ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á)                  |
| **ResourceQuota**              | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ namespace ‡πÉ‡∏ä‡πâ resource ‡πÄ‡∏Å‡∏¥‡∏ô quota ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà                            |
| **PodSecurity**                | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö policy ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô privileged, root user)                         |
| **MutatingAdmissionWebhook**   | ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å external webhook ‡πÄ‡∏û‡∏∑‡πà‡∏≠ "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" request ‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å                         |
| **ValidatingAdmissionWebhook** | ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å external webhook ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‚Äù request ‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å                       |

---

## üí° **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**

### üî∏ Example 1: LimitRanger

‡∏ñ‡πâ‡∏≤ namespace ‡∏°‡∏µ‡∏Å‡∏é‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å Pod ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ CPU limit ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 100m
‡∏ñ‡πâ‡∏≤‡πÉ‡∏Ñ‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Pod ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà limit ‚Üí Admission Controller ‡∏à‡∏∞ ‚Äú‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‚Äù request

---

### üî∏ Example 2: MutatingAdmissionWebhook

‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á Istio ‡∏´‡∏£‡∏∑‡∏≠ Linkerd ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ **inject sidecar (proxy)** ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Pod ‡∏ï‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á
‡πÇ‡∏î‡∏¢ user ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á manifest ‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢

---

### üî∏ Example 3: PodSecurity

‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤ security context ‡∏Ç‡∏≠‡∏á Pod ‡πÄ‡∏ä‡πà‡∏ô

* ‡πÉ‡∏ä‡πâ root ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
* ‡∏°‡∏µ capabilities ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡πÑ‡∏´‡∏°
* ‡πÉ‡∏ä‡πâ host network ‡∏´‡∏£‡∏∑‡∏≠ privileged ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤

‡∏ñ‡πâ‡∏≤‡∏ú‡∏¥‡∏î policy ‚Üí ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò

---

## üß∞ **Admission Webhooks (Custom Controllers)**

‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å plugin ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏° Kubernetes ‡πÅ‡∏•‡πâ‡∏ß
‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á **Admission Webhook** ‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏é‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ ‡πÄ‡∏ä‡πà‡∏ô

* ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á Pod ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ label `team=xxx`
* ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ image ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ scan vulnerability
* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç field ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏° annotation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö monitoring

Admission Webhook ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô service ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö request ‡∏à‡∏≤‡∏Å API Server ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ß‡πà‡∏≤ ‚Äú‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‚Äù

---

## üß† **‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**

```
Request (kubectl / Pod / Controller)
   ‚Üì
Authentication  ‚Üí  ‡πÉ‡∏Ñ‡∏£?
   ‚Üì
Authorization   ‚Üí  ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°?
   ‚Üì
Admission Control ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°?
   ‚Üì
etcd (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)
```

---

## üîí **Best Practices**

‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Admission Controller ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ä‡πà‡∏ô:

```
--enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,ResourceQuota,NodeRestriction,PodSecurity
```

‚úÖ ‡πÉ‡∏ä‡πâ Admission Webhook ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö enforce policy ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
‚úÖ ‡πÉ‡∏ä‡πâ **PodSecurity Admission (PSA)** ‡πÅ‡∏ó‡∏ô PodSecurityPolicy (‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß)
‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö policy ‡∏Å‡πà‡∏≠‡∏ô deploy ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ dry-run

---

‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏ß‡∏≤‡∏î ‚Äú‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û flow ‡∏Ç‡∏≠‡∏á Admission Control‚Äù ‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö
‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î‡∏°‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà user ‡∏™‡πà‡∏á `kubectl apply` ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á etcd üí°
